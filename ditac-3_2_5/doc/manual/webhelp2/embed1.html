<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
   <head><meta charset="UTF-8" />
      
      <title>Part III, Chapter 12. High-level method: embedding com.xmlmind.ditac.convert.Converter</title>
      <link href="resources/webhelp.css" rel="stylesheet" type="text/css" />
      <meta content="Quick and easy embedding: embed com.xmlmind.ditac.convert.Converter, the Java class which is used to implement the ditac command-line utility." name="description" />
      <meta content="XMLmind DITA Converter 3.2.5" name="generator" />
   <script charset="UTF-8" defer="defer" src="_wh/snowball_en.min.js" type="text/javascript"></script><link href="_wh/wh.css" rel="stylesheet" type="text/css" /><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript">
    </script><script charset="UTF-8" src="_wh/wh.min.js" type="text/javascript">
    </script><script charset="UTF-8" defer="defer" src="_wh/search.js" type="text/javascript">
    </script><link href="_wh/user/header_footer.css" rel="stylesheet" type="text/css" /></head>
   
<body>
    <div id="wh-header">
    <table id="page-header" style="border-spacing: 0; width: 100%;">
      <tr>
        <td style="vertical-align: middle; width: 110px;"><a href="http://www.xmlmind.com/"><img alt="XMLmind logo" height="50" src="_wh/user/header_footer_files/logo100x50.png" style="border-style: none;" width="100" /></a></td>

        <td style="vertical-align: middle;"><h1 id="page-header-title">XMLmind
        DITA Converter Manual</h1></td>

        <td style="vertical-align: middle; width: 110px;"> </td>
      </tr>
    </table></div>

    <div id="wh-body">
      <div id="wh-navigation">
        <div id="wh-navigation-form">
          <span id="wh-search-group">
            <span id="wh-do-search" title="Search"></span><input id="wh-search-field" placeholder="Search" type="text" /><span id="wh-cancel-search" title="Stop searching"></span>
          </span>
        </div>
        <div id="wh-toc-pane">
          <script charset="UTF-8" src="_wh/toc.js" type="text/javascript"></script>
        </div>
        <div id="wh-search-pane">
          <div id="wh-search-results">
          </div>
        </div>
      </div>
      <div id="wh-content">
      
      <section class="topic" id="embed1" lang="en-US" xml:lang="en-US">
         <h2 class="chapter-title">Chapter 12. High-level method: embedding
            <code class="apiname">com.xmlmind.ditac.convert.Converter</code> <span class="topic-navigation-bar"><img alt="Previous topic" class="navigation-icon-disabled" height="16" src="resources/previous_disabled.png" title="Previous topic" width="16" /> <a class="navigation-link" href="manual-7.html#I_srdxlf_" title="Parent topic: Part III. Embedding XMLmind DITA Converter in a Java™ application"><img alt="Parent topic" class="navigation-icon" height="16" src="resources/parent.png" width="16" /></a> <img alt="Child topic" class="navigation-icon-disabled" height="16" src="resources/child_disabled.png" title="Child topic" width="16" /> <a class="navigation-link" href="embed2.html#embed2" title="Next topic: Chapter 13. Low-level method: embedding com.xmlmind.ditac.preprocess.PreProcessor"><img alt="Next topic" class="navigation-icon" height="16" src="resources/next.png" width="16" /></a></span></h2>
         <p class="shortdesc">Quick and easy embedding: embed
            <code class="apiname">com.xmlmind.ditac.convert.Converter</code>, the <span class="tm">Java™</span> class which is used to implement the
            <code class="cmdname">ditac</code> command-line utility.
         </p>
         <div class="body">
            <div class="p"><a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html" target="_blank">Converter <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a> is the object which is at the core of
               the <code class="cmdname">ditac</code> command-line utility. Its <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#run-java.lang.String[]-" target="_blank">run <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a> method accepts the same string arguments as
               the <a class="xref" href="commandLine.html#commandLine"><code class="cmdname">ditac</code> command-line
                  utility</a>.
            </div>
            <div class="p">The full source code of the <code class="apiname">Embed1</code> sample is found
               in <a class="xref" href="../embed/Embed1.java" target="_blank"><code class="filepath">Embed1.java</code> <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>.
            </div>
            <ol class="ol">
               <li class="li">
                  <div class="p">Create the <code class="apiname">Converter</code>.
                  </div><pre class="pre language-java">StyleSheetCache cache = <span class="hl-keyword">new</span> StyleSheetCache();

Console console = <span class="hl-keyword">new</span> Console() {
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> showMessage(String message, MessageType messageType) {
        System.err.println(message);
    }
};

Converter converter = <span class="hl-keyword">new</span> Converter(cache, console);</pre><ul class="ul">
                     <li class="li">
                        <div class="p"><a class="xref" href="../../api/com/xmlmind/ditac/convert/StyleSheetCache.html" target="_blank">StyleSheetCache <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a> is a simple cache for the
                           ditac XSLT 2.0 stylesheets. It is a thread-safe object which is
                           intended to be shared by several
                           <code class="apiname">Converter</code>s.
                        </div>
                        <div class="p">Unlike
                           <code class="apiname">StyleSheetCache</code>, <code class="apiname">Converter</code> is
                           not thread-safe. Each thread must own its
                           <code class="apiname">Converter</code>. However, the <code class="apiname">run</code>
                           method of a <code class="apiname">Converter</code> may be invoked several
                           times.
                        </div>
                     </li>
                     <li class="li">
                        <div class="p"><a class="xref" href="../../api/com/xmlmind/util/Console.html" target="_blank">Console <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a> is a very simple interface.
                           Implementing this interface allows to do whatever you want with the
                           messages reported by a <code class="apiname">Converter</code>.
                        </div>
                     </li>
                  </ul>
               </li>
               <li class="li">
                  <div class="p">Configure the <code class="apiname">Converter</code>.
                  </div><pre class="pre language-java"><span class="hl-keyword">if</span> (!converter.registerFOP(path(<span class="hl-string">&quot;/opt/fop/fop&quot;</span>))) {
    <span class="hl-keyword">return</span> <span class="hl-number">1</span>;
}

File xslDir = <span class="hl-keyword">new</span> File(path(<span class="hl-string">&quot;../../../xsl&quot;</span>));
System.setProperty(<span class="hl-string">&quot;DITAC_XSL_DIR&quot;</span>, xslDir.getAbsolutePath());</pre><ul class="ul">
                     <li class="li">
                        <div class="p">There are several methods which allows to register an XSL-FO
                           processor with a <code class="apiname">Converter</code>. From high-level ones
                           to low-level ones, these methods are: <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerFOP-java.lang.String-" target="_blank">registerFOP <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>, <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerXEP-java.lang.String-" target="_blank">registerXEP <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>, <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerAHF-java.lang.String-" target="_blank">registerAHF <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>, <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerXFC-java.lang.String-" target="_blank">registerXFC <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>, <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerExternalFOConverter-java.lang.String-com.xmlmind.ditac.convert.Format-java.lang.String-" target="_blank">registerExternalFOConverter <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>, <a class="xref" href="../../api/com/xmlmind/ditac/convert/Converter.html#registerFOConverter-com.xmlmind.ditac.convert.FOConverter-" target="_blank">registerFOConverter <img alt="Opens in new window" height="10" src="resources/new_window.png" style="border-style: none;" width="10" /></a>.
                        </div>
                     </li>
                  </ul>
                  <ul class="ul">
                     <li class="li">
                        <div class="p">A <code class="apiname">Converter</code> can automatically determine
                           where to find the directory containing all the ditac XSLT 2.0
                           stylesheets. It assumes that <code class="filepath">ditac.jar</code> is in
                           the class path of <span class="tm">Java™</span>. It also assumes that
                           <code class="filepath">ditac.jar</code> is contained in a
                           <code class="filepath">lib/</code> directory. The<code class="filepath"> xsl/</code>
                           directory is assumed to be a sibling of the
                           <code class="filepath">lib/</code> directory.
                        </div>
                        <div class="p">However, the situation
                           may be very different in applications other than the
                           <code class="cmdname">ditac</code> command-line. That's why you may need to
                           set the <span class="tt">DITAC_XSL_DIR</span> system property to the absolute path
                           of the <code class="filepath">xsl/</code> directory containing the XSLT
                           stylesheets.
                        </div>
                     </li>
                  </ul>
               </li>
               <li class="li">
                  <div class="p">Invoke the <code class="apiname">run</code> method.
                  </div><pre class="pre language-java">String[] args = {
    <span class="hl-string">&quot;-v&quot;</span>,
    <span class="hl-string">&quot;-p&quot;</span>, <span class="hl-string">&quot;number&quot;</span>, <span class="hl-string">&quot;all&quot;</span>,
    outFile.getPath(),
    inFile.getPath(),
};

<span class="hl-keyword">return</span> converter.run(args);</pre><div class="p">The <code class="apiname">run</code> method returns
                     0 if the conversion is successful and an integer greater than 0
                     otherwise. When the conversion fails, errors messages are displayed on
                     the <code class="apiname">Console</code>.
                  </div>
               </li>
            </ol>
            <section class="section" id="embed1__I_wh7es2_">
               <h3 class="section-title">Compiling and executing the <code class="apiname">Embed1</code>
                  sample
               </h3>
               <div class="p">Compile the <code class="apiname">Embed1</code> sample by running
                  <code class="cmdname">ant</code> in
                  <code class="filepath"><var class="varname">ditac_install_dir</var>/doc/manual/embed/</code>.
               </div>
               <div class="p">Execute
                  the <code class="apiname">Embed1</code> sample by running
                  <code class="cmdname">ant</code> <span class="tt">embed1</span> in
                  <code class="filepath"><var class="varname">ditac_install_dir</var>/doc/manual/embed/</code>.
                  This will convert
                  <code class="filepath"><var class="varname">ditac_install_dir</var>/docsrc/manual/manual.ditamap</code>
                  to
                  <code class="filepath"><var class="varname">ditac_install_dir</var>/doc/manual/embed/manual.pdf</code>,
                  using Apache FOP.
               </div>
               <div class="p">Note that <code class="filepath">Embed1.java</code>
                  contains ``hardwired filenames''. This means that this sample cannot be
                  run from elsewhere than
                  <code class="filepath"><var class="varname">ditac_install_dir</var>/doc/manual/embed/</code>
                  and that you'll almost certainly need to modify the source code in order
                  to specify the actual location of the <code class="filepath">fop</code>
                  (<code class="filepath">fop.bat</code>) script.
               </div>
            </section>
         </div>
         <nav class="related-links">
            <h3 class="related-links-title">Related information</h3>
            <p class="link">‣ <a href="embed2.html#embed2" title="Advanced embedding method: first invoke a preprocessor which will generate intermediate .ditac files, then invoke the XSLT 2.0 engine in order to transform all these .ditac files.">Chapter 13. Low-level method: embedding
                  <code class="apiname">com.xmlmind.ditac.preprocess.PreProcessor</code></a></p>
         </nav>
      </section>
   </div>
    </div>

    <div id="wh-footer">
    <p id="page-footer">Web Help generated using <a href="http://www.xmlmind.com/ditac/" target="_blank">XMLmind DITA Converter</a>.</p></div>
  </body></html>